#!/usr/bin/env python

from wrf4g_env import *
from WRF4Glib  import VarEnv
   
usage="""

%prog -f exp_file [--help]

Synopsys:

wrf4g_expvar command to export the environment variables of a reosurce file. 
"""  
parser = OptionParser(usage,version="%prog 1.0")
parser.add_option("-f", "--file",metavar="name",dest="file", help="Name of the file")

(options, args) = parser.parse_args()

try:
    if options.file :
        resource_name  = os.environ.get('GW_HOSTNAME')
        resource_env   = VarEnv( options.file )
        section_to_use = 'DEFAULT' 
        for section in resource_env.sections() : 
            if section.startswith( resource_name ) : 
                section_to_use = section
                break
        with open( options.file , 'w' ) as file :
            [ file.write( "%s=%s\n" % ( key.upper() , val ) ) for key, val in resource_env.items( section_to_use  ) ]
    else :
        print "You MUST indicate a file"
except Exception, err:
    print str( err )
    sys.exit(-1)


